/// <reference path='_all.ts' />
var todos;
(function (todos) {
    var TodoItem = (function () {
        function TodoItem(title, completed) {
            this.title = title;
            this.completed = completed;
        }
        return TodoItem;
    })();
    todos.TodoItem = TodoItem;
})(todos || (todos = {}));
/// <reference path='_all.ts' />
/// <reference path='_all.ts' />
var todos;
(function (todos_1) {
    'use strict';
    var TodoStorage = (function () {
        function TodoStorage() {
            this.STORAGE_ID = 'todos-angularjs-typescript';
        }
        TodoStorage.prototype.get = function () {
            return JSON.parse(localStorage.getItem(this.STORAGE_ID) || '[]');
        };
        TodoStorage.prototype.put = function (todos) {
            localStorage.setItem(this.STORAGE_ID, JSON.stringify(todos));
        };
        return TodoStorage;
    })();
    todos_1.TodoStorage = TodoStorage;
})(todos || (todos = {}));
/// <reference path='_all.ts' />
var todos;
(function (todos) {
    'use strict';
    var TodoCtrl = (function () {
        function TodoCtrl($scope, $location, filterFilter, todoStorage) {
            //this.todos = $scope.todos = [
            //    {
            //        title: 'test001',
            //        completed: false
            //    },
            //    {
            //        title: 'test002',
            //        completed: true
            //    }
            //];
            var _this = this;
            this.$scope = $scope;
            this.$location = $location;
            this.filterFilter = filterFilter;
            this.todoStorage = todoStorage;
            $scope.todos = this.todos = todoStorage.get();
            console.log($scope.todos);
            $scope.newTodo = '';
            $scope.editTodo = null;
            $scope.vm = this;
            $scope.$watch('todos', function () { return _this.onTodos(); }, true);
            $scope.$watch(function () { return $location.path(); }, function (path) { return _this.onPath(path); });
            if ($location.path() === '')
                $location.path('/');
            $scope.location = $location;
        }
        TodoCtrl.prototype.onPath = function (path) {
            this.$scope.statusFilter = (path === '/active') ? { completed: false } : (path === '/completed') ? { completed: true } : null;
        };
        TodoCtrl.prototype.onTodos = function () {
            this.todoStorage.put(this.todos);
            this.$scope.remainingCount = this.filterFilter(this.todos, { completed: false }).length;
            this.$scope.allChecked = !this.$scope.remainingCount;
        };
        TodoCtrl.prototype.addTodo = function () {
            var newTodo = this.$scope.newTodo.trim();
            if (!newTodo) {
                return;
            }
            this.todos.push({ title: newTodo, completed: false });
            this.$scope.newTodo = '';
        };
        TodoCtrl.prototype.removeTodo = function (todo) {
            this.todos.splice(this.todos.indexOf(todo), 1);
        };
        TodoCtrl.prototype.editTodo = function (todo) {
            this.$scope.editTodo = todo;
        };
        TodoCtrl.prototype.doneEditTodo = function (todo) {
            this.$scope.editTodo = null;
            todo.title = todo.title.trim();
            if (!todo.title) {
                this.removeTodo(todo);
            }
        };
        TodoCtrl.prototype.checkAll = function (allChecked) {
            this.$scope.todos.forEach(function (todo) {
                todo.completed = allChecked;
            });
        };
        TodoCtrl.$inject = [
            '$scope',
            '$location',
            'filterFilter',
            'todoStorage'
        ];
        return TodoCtrl;
    })();
    todos.TodoCtrl = TodoCtrl;
})(todos || (todos = {}));
/// <reference path='_all.ts' />
var todos;
(function (todos) {
    'use strict';
    var todomvc = angular.module('todomvc', [])
        .service('todoStorage', todos.TodoStorage)
        .controller('todoCtr', todos.TodoCtrl);
})(todos || (todos = {}));
/// <reference path='typings/jquery/jquery.d.ts' />
/// <reference path='typings/angularjs/angular.d.ts' />
/// <reference path='model.ts' />
/// <reference path='interfaces.ts' />
/// <reference path='TodoStorage.ts' />
/// <reference path='todoCtrl.ts' />
/// <reference path='application.ts' />

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVsLnRzIiwiaW50ZXJmYWNlcy50cyIsIlRvZG9TdG9yYWdlLnRzIiwidG9kb0N0cmwudHMiLCJhcHBsaWNhdGlvbi50cyIsIl9hbGwudHMiXSwibmFtZXMiOlsidG9kb3MiLCJ0b2Rvcy5Ub2RvSXRlbSIsInRvZG9zLlRvZG9JdGVtLmNvbnN0cnVjdG9yIiwidG9kb3MuVG9kb1N0b3JhZ2UiLCJ0b2Rvcy5Ub2RvU3RvcmFnZS5jb25zdHJ1Y3RvciIsInRvZG9zLlRvZG9TdG9yYWdlLmdldCIsInRvZG9zLlRvZG9TdG9yYWdlLnB1dCIsInRvZG9zLlRvZG9DdHJsIiwidG9kb3MuVG9kb0N0cmwuY29uc3RydWN0b3IiLCJ0b2Rvcy5Ub2RvQ3RybC5vblBhdGgiLCJ0b2Rvcy5Ub2RvQ3RybC5vblRvZG9zIiwidG9kb3MuVG9kb0N0cmwuYWRkVG9kbyIsInRvZG9zLlRvZG9DdHJsLnJlbW92ZVRvZG8iLCJ0b2Rvcy5Ub2RvQ3RybC5lZGl0VG9kbyIsInRvZG9zLlRvZG9DdHJsLmRvbmVFZGl0VG9kbyIsInRvZG9zLlRvZG9DdHJsLmNoZWNrQWxsIl0sIm1hcHBpbmdzIjoiQUFBQSxnQ0FBZ0M7QUFFaEMsSUFBTyxLQUFLLENBT1g7QUFQRCxXQUFPLEtBQUssRUFBQyxDQUFDO0lBQ1ZBO1FBQ0lDLGtCQUNXQSxLQUFhQSxFQUNiQSxTQUFrQkE7WUFEbEJDLFVBQUtBLEdBQUxBLEtBQUtBLENBQVFBO1lBQ2JBLGNBQVNBLEdBQVRBLFNBQVNBLENBQVNBO1FBQzNCQSxDQUFDQTtRQUNQRCxlQUFDQTtJQUFEQSxDQUxBRCxBQUtDQyxJQUFBRDtJQUxZQSxjQUFRQSxXQUtwQkEsQ0FBQUE7QUFDTEEsQ0FBQ0EsRUFQTSxLQUFLLEtBQUwsS0FBSyxRQU9YO0FDVEQsZ0NBQWdDO0FDQWhDLGdDQUFnQztBQUVoQyxJQUFPLEtBQUssQ0FrQlg7QUFsQkQsV0FBTyxPQUFLLEVBQUMsQ0FBQztJQUNWQSxZQUFZQSxDQUFDQTtJQUtiQTtRQUFBRztZQUVJQyxlQUFVQSxHQUFHQSw0QkFBNEJBLENBQUNBO1FBUzlDQSxDQUFDQTtRQVBHRCx5QkFBR0EsR0FBSEE7WUFDSUUsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDckVBLENBQUNBO1FBRURGLHlCQUFHQSxHQUFIQSxVQUFJQSxLQUFpQkE7WUFDakJHLFlBQVlBLENBQUNBLE9BQU9BLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEVBQUVBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBO1FBQ2pFQSxDQUFDQTtRQUNMSCxrQkFBQ0E7SUFBREEsQ0FYQUgsQUFXQ0csSUFBQUg7SUFYWUEsbUJBQVdBLGNBV3ZCQSxDQUFBQTtBQUNMQSxDQUFDQSxFQWxCTSxLQUFLLEtBQUwsS0FBSyxRQWtCWDtBQ3BCRCxnQ0FBZ0M7QUFFaEMsSUFBTyxLQUFLLENBOEVYO0FBOUVELFdBQU8sS0FBSyxFQUFDLENBQUM7SUFFVkEsWUFBWUEsQ0FBQ0E7SUFDYkE7UUFTSU8sa0JBQ1lBLE1BQWtCQSxFQUNsQkEsU0FBOEJBLEVBQzlCQSxZQUFZQSxFQUNaQSxXQUF3QkE7WUFFNUJDLCtCQUErQkE7WUFDL0JBLE9BQU9BO1lBQ1BBLDJCQUEyQkE7WUFDM0JBLDBCQUEwQkE7WUFDMUJBLFFBQVFBO1lBQ1JBLE9BQU9BO1lBQ1BBLDJCQUEyQkE7WUFDM0JBLHlCQUF5QkE7WUFDekJBLE9BQU9BO1lBQ1BBLElBQUlBO1lBeEJoQkEsaUJBMEVDQTtZQWhFZUEsV0FBTUEsR0FBTkEsTUFBTUEsQ0FBWUE7WUFDbEJBLGNBQVNBLEdBQVRBLFNBQVNBLENBQXFCQTtZQUM5QkEsaUJBQVlBLEdBQVpBLFlBQVlBLENBQUFBO1lBQ1pBLGdCQUFXQSxHQUFYQSxXQUFXQSxDQUFhQTtZQWE1QkEsTUFBTUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsV0FBV0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0E7WUFDOURBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO1lBQ1ZBLE1BQU1BLENBQUNBLE9BQU9BLEdBQUdBLEVBQUVBLENBQUNBO1lBQ3BCQSxNQUFNQSxDQUFDQSxRQUFRQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUN2QkEsTUFBTUEsQ0FBQ0EsRUFBRUEsR0FBR0EsSUFBSUEsQ0FBQ0E7WUFFakJBLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBLE9BQU9BLEVBQUNBLGNBQU1BLE9BQUFBLEtBQUlBLENBQUNBLE9BQU9BLEVBQUVBLEVBQWRBLENBQWNBLEVBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ2pEQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQSxjQUFLQSxPQUFBQSxTQUFTQSxDQUFDQSxJQUFJQSxFQUFFQSxFQUFoQkEsQ0FBZ0JBLEVBQUNBLFVBQUFBLElBQUlBLElBQUlBLE9BQUFBLEtBQUlBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEVBQWpCQSxDQUFpQkEsQ0FBQ0EsQ0FBQ0E7WUFDL0RBLEVBQUVBLENBQUFBLENBQUNBLFNBQVNBLENBQUNBLElBQUlBLEVBQUVBLEtBQUtBLEVBQUVBLENBQUNBO2dCQUFDQSxTQUFTQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUNoREEsTUFBTUEsQ0FBQ0EsUUFBUUEsR0FBR0EsU0FBU0EsQ0FBQ0E7UUFFcENBLENBQUNBO1FBQ0RELHlCQUFNQSxHQUFOQSxVQUFPQSxJQUFXQTtZQUNkRSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxZQUFZQSxHQUFHQSxDQUFDQSxJQUFJQSxLQUFLQSxTQUFTQSxDQUFDQSxHQUFHQSxFQUFDQSxTQUFTQSxFQUFDQSxLQUFLQSxFQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxLQUFLQSxZQUFZQSxDQUFDQSxHQUFFQSxFQUFDQSxTQUFTQSxFQUFFQSxJQUFJQSxFQUFDQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUU1SEEsQ0FBQ0E7UUFDREYsMEJBQU9BLEdBQVBBO1lBQ0lHLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO1lBQ2pDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxjQUFjQSxHQUFHQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxFQUFDQSxFQUFDQSxTQUFTQSxFQUFFQSxLQUFLQSxFQUFDQSxDQUFDQSxDQUFDQSxNQUFNQSxDQUFDQTtZQUNyRkEsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsY0FBY0EsQ0FBQ0E7UUFDekRBLENBQUNBO1FBQ0RILDBCQUFPQSxHQUFQQTtZQUNJSSxJQUFJQSxPQUFPQSxHQUFVQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxPQUFPQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtZQUVoREEsRUFBRUEsQ0FBQUEsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7Z0JBQ1RBLE1BQU1BLENBQUNBO1lBQ1hBLENBQUNBO1lBQ0RBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBLEVBQUNBLEtBQUtBLEVBQUNBLE9BQU9BLEVBQUNBLFNBQVNBLEVBQUNBLEtBQUtBLEVBQUNBLENBQUNBLENBQUNBO1lBQ2pEQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxPQUFPQSxHQUFHQSxFQUFFQSxDQUFDQTtRQUM3QkEsQ0FBQ0E7UUFDREosNkJBQVVBLEdBQVZBLFVBQVdBLElBQWNBO1lBQ3JCSyxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxFQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNsREEsQ0FBQ0E7UUFDREwsMkJBQVFBLEdBQVJBLFVBQVNBLElBQWNBO1lBQ25CTSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxRQUFRQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUNoQ0EsQ0FBQ0E7UUFDRE4sK0JBQVlBLEdBQVpBLFVBQWFBLElBQWFBO1lBQ3RCTyxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxRQUFRQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUM1QkEsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsRUFBRUEsQ0FBQ0E7WUFDL0JBLEVBQUVBLENBQUFBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLENBQUFBLENBQUNBO2dCQUNaQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUMxQkEsQ0FBQ0E7UUFDTEEsQ0FBQ0E7UUFDRFAsMkJBQVFBLEdBQVJBLFVBQVNBLFVBQW1CQTtZQUN4QlEsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsVUFBQUEsSUFBSUE7Z0JBQzFCQSxJQUFJQSxDQUFDQSxTQUFTQSxHQUFHQSxVQUFVQSxDQUFDQTtZQUNoQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDUEEsQ0FBQ0E7UUF0RWFSLGdCQUFPQSxHQUFHQTtZQUNwQkEsUUFBUUE7WUFDUkEsV0FBV0E7WUFDWEEsY0FBY0E7WUFDZEEsYUFBYUE7U0FDaEJBLENBQUNBO1FBa0VOQSxlQUFDQTtJQUFEQSxDQTFFQVAsQUEwRUNPLElBQUFQO0lBMUVZQSxjQUFRQSxXQTBFcEJBLENBQUFBO0FBQ0xBLENBQUNBLEVBOUVNLEtBQUssS0FBTCxLQUFLLFFBOEVYO0FDaEZELGdDQUFnQztBQUVoQyxJQUFPLEtBQUssQ0FNWDtBQU5ELFdBQU8sS0FBSyxFQUFDLENBQUM7SUFDVkEsWUFBWUEsQ0FBQ0E7SUFFYkEsSUFBSUEsT0FBT0EsR0FBR0EsT0FBT0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsU0FBU0EsRUFBQ0EsRUFBRUEsQ0FBQ0E7U0FDckNBLE9BQU9BLENBQUNBLGFBQWFBLEVBQUNBLGlCQUFXQSxDQUFDQTtTQUNsQ0EsVUFBVUEsQ0FBQ0EsU0FBU0EsRUFBQ0EsY0FBUUEsQ0FBQ0EsQ0FBQUE7QUFDdkNBLENBQUNBLEVBTk0sS0FBSyxLQUFMLEtBQUssUUFNWDtBQ1JELG1EQUFtRDtBQUNuRCx1REFBdUQ7QUFDdkQsaUNBQWlDO0FBQ2pDLHNDQUFzQztBQUN0Qyx1Q0FBdUM7QUFDdkMsb0NBQW9DO0FBQ3BDLHVDQUF1QyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPSdfYWxsLnRzJyAvPlxuXG5tb2R1bGUgdG9kb3Mge1xuICAgIGV4cG9ydCBjbGFzcyBUb2RvSXRlbSB7XG4gICAgICAgIGNvbnN0cnVjdG9yIChcbiAgICAgICAgICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nLFxuICAgICAgICAgICAgcHVibGljIGNvbXBsZXRlZDogYm9vbGVhblxuICAgICAgICApe31cbiAgICB9XG59IiwiLy8vIDxyZWZlcmVuY2UgcGF0aD0nX2FsbC50cycgLz5cblxubW9kdWxlIHRvZG9zIHtcbiAgICBleHBvcnQgaW50ZXJmYWNlIElUb2RvU2NvcGUgZXh0ZW5kcyBuZy5JU2NvcGUge1xuICAgICAgICB0b2RvczogVG9kb0l0ZW1bXTtcbiAgICAgICAgbmV3VG9kbzogc3RyaW5nO1xuICAgICAgICBlZGl0VG9kbyA6IFRvZG9JdGVtO1xuICAgICAgICByZW1haW5pbmdDb3VudDogbnVtYmVyO1xuICAgICAgICBkb25lQ291bnQ6IG51bWJlcjtcbiAgICAgICAgYWxsQ2hlY2tlZDogYm9vbGVhbjtcbiAgICAgICAgc3RhdHVzRmlsdGVyOiB7IGNvbXBsZXRlZDogYm9vbGVhbjsgfTtcbiAgICAgICAgbG9jYXRpb246IG5nLklMb2NhdGlvblNlcnZpY2U7XG4gICAgICAgIHZtOiBUb2RvQ3RybDtcbiAgICB9XG5cbiAgICBleHBvcnQgaW50ZXJmYWNlIElUb2RvU3RvcmFnZSB7XG4gICAgICAgIGdldCAoKTogVG9kb0l0ZW1bXTtcbiAgICAgICAgcHV0KHRvZG9zOiBUb2RvSXRlbVtdKTtcbiAgICB9XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPSdfYWxsLnRzJyAvPlxuXG5tb2R1bGUgdG9kb3Mge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8qKlxuICAgICAqICAgICAgKiBTZXJ2aWNlcyB0aGF0IHBlcnNpc3RzIGFuZCByZXRyaWV2ZXMgVE9ET3MgZnJvbSBsb2NhbFN0b3JhZ2UuXG4gICAgICogICAgICAgICAgICovXG4gICAgZXhwb3J0IGNsYXNzIFRvZG9TdG9yYWdlIGltcGxlbWVudHMgSVRvZG9TdG9yYWdlIHtcblxuICAgICAgICBTVE9SQUdFX0lEID0gJ3RvZG9zLWFuZ3VsYXJqcy10eXBlc2NyaXB0JztcblxuICAgICAgICBnZXQgKCk6IFRvZG9JdGVtW10ge1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5TVE9SQUdFX0lEKSB8fCAnW10nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHB1dCh0b2RvczogVG9kb0l0ZW1bXSkge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5TVE9SQUdFX0lELCBKU09OLnN0cmluZ2lmeSh0b2RvcykpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD0nX2FsbC50cycgLz5cblxubW9kdWxlIHRvZG9zIHtcblxuICAgICd1c2Ugc3RyaWN0JztcbiAgICBleHBvcnQgY2xhc3MgVG9kb0N0cmwge1xuICAgICAgICBwcml2YXRlIHRvZG9zOiBUb2RvSXRlbVtdO1xuXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgJGluamVjdCA9IFtcbiAgICAgICAgICAgICckc2NvcGUnLFxuICAgICAgICAgICAgJyRsb2NhdGlvbicsXG4gICAgICAgICAgICAnZmlsdGVyRmlsdGVyJyxcbiAgICAgICAgICAgICd0b2RvU3RvcmFnZSdcbiAgICAgICAgXTtcbiAgICAgICAgY29uc3RydWN0b3IoXG4gICAgICAgICAgICBwcml2YXRlICRzY29wZTogSVRvZG9TY29wZSxcbiAgICAgICAgICAgIHByaXZhdGUgJGxvY2F0aW9uOiBuZy5JTG9jYXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAgcHJpdmF0ZSBmaWx0ZXJGaWx0ZXIsXG4gICAgICAgICAgICBwcml2YXRlIHRvZG9TdG9yYWdlOklUb2RvU3RvcmFnZVxuICAgICAgICApe1xuICAgICAgICAgICAgICAgIC8vdGhpcy50b2RvcyA9ICRzY29wZS50b2RvcyA9IFtcbiAgICAgICAgICAgICAgICAvLyAgICB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRpdGxlOiAndGVzdDAwMScsXG4gICAgICAgICAgICAgICAgLy8gICAgICAgIGNvbXBsZXRlZDogZmFsc2VcbiAgICAgICAgICAgICAgICAvLyAgICB9LFxuICAgICAgICAgICAgICAgIC8vICAgIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGl0bGU6ICd0ZXN0MDAyJyxcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgY29tcGxldGVkOiB0cnVlXG4gICAgICAgICAgICAgICAgLy8gICAgfVxuICAgICAgICAgICAgICAgIC8vXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAkc2NvcGUudG9kb3MgPSB0aGlzLnRvZG9zID0gdG9kb1N0b3JhZ2UuZ2V0KCk7XG5jb25zb2xlLmxvZygkc2NvcGUudG9kb3MpO1xuICAgICAgICAgICAgICAgICRzY29wZS5uZXdUb2RvID0gJyc7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVkaXRUb2RvID0gbnVsbDtcbiAgICAgICAgICAgICAgICAkc2NvcGUudm0gPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgndG9kb3MnLCgpID0+IHRoaXMub25Ub2RvcygpLHRydWUpO1xuICAgICAgICAgICAgICAgICRzY29wZS4kd2F0Y2goKCk9PiAkbG9jYXRpb24ucGF0aCgpLHBhdGggPT4gdGhpcy5vblBhdGgocGF0aCkpO1xuICAgICAgICAgICAgICAgIGlmKCRsb2NhdGlvbi5wYXRoKCkgPT09ICcnKSAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICAgICAgICAgICRzY29wZS5sb2NhdGlvbiA9ICRsb2NhdGlvbjtcblxuICAgICAgICB9XG4gICAgICAgIG9uUGF0aChwYXRoOnN0cmluZykge1xuICAgICAgICAgICAgdGhpcy4kc2NvcGUuc3RhdHVzRmlsdGVyID0gKHBhdGggPT09ICcvYWN0aXZlJykgPyB7Y29tcGxldGVkOmZhbHNlfSA6IChwYXRoID09PSAnL2NvbXBsZXRlZCcpPyB7Y29tcGxldGVkOiB0cnVlfSA6IG51bGw7XG5cbiAgICAgICAgfVxuICAgICAgICBvblRvZG9zKCkge1xuICAgICAgICAgICAgdGhpcy50b2RvU3RvcmFnZS5wdXQodGhpcy50b2Rvcyk7XG4gICAgICAgICAgICB0aGlzLiRzY29wZS5yZW1haW5pbmdDb3VudCA9IHRoaXMuZmlsdGVyRmlsdGVyKHRoaXMudG9kb3Mse2NvbXBsZXRlZDogZmFsc2V9KS5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLiRzY29wZS5hbGxDaGVja2VkID0gIXRoaXMuJHNjb3BlLnJlbWFpbmluZ0NvdW50O1xuICAgICAgICB9XG4gICAgICAgIGFkZFRvZG8oKSB7XG4gICAgICAgICAgICB2YXIgbmV3VG9kbzpzdHJpbmcgPSB0aGlzLiRzY29wZS5uZXdUb2RvLnRyaW0oKTtcblxuICAgICAgICAgICAgaWYoIW5ld1RvZG8pe1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudG9kb3MucHVzaCh7dGl0bGU6bmV3VG9kbyxjb21wbGV0ZWQ6ZmFsc2V9KTtcbiAgICAgICAgICAgIHRoaXMuJHNjb3BlLm5ld1RvZG8gPSAnJztcbiAgICAgICAgfVxuICAgICAgICByZW1vdmVUb2RvKHRvZG86IFRvZG9JdGVtICkgIHtcbiAgICAgICAgICAgIHRoaXMudG9kb3Muc3BsaWNlKHRoaXMudG9kb3MuaW5kZXhPZih0b2RvKSwxKTtcbiAgICAgICAgfVxuICAgICAgICBlZGl0VG9kbyh0b2RvOiBUb2RvSXRlbSkge1xuICAgICAgICAgICAgdGhpcy4kc2NvcGUuZWRpdFRvZG8gPSB0b2RvO1xuICAgICAgICB9XG4gICAgICAgIGRvbmVFZGl0VG9kbyh0b2RvOlRvZG9JdGVtKXtcbiAgICAgICAgICAgIHRoaXMuJHNjb3BlLmVkaXRUb2RvID0gbnVsbDtcbiAgICAgICAgICAgIHRvZG8udGl0bGUgPSB0b2RvLnRpdGxlLnRyaW0oKTtcbiAgICAgICAgICAgIGlmKCF0b2RvLnRpdGxlKXtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVRvZG8odG9kbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2hlY2tBbGwoYWxsQ2hlY2tlZDogYm9vbGVhbikge1xuICAgICAgICAgICAgdGhpcy4kc2NvcGUudG9kb3MuZm9yRWFjaCh0b2RvID0+eyBcbiAgICAgICAgICAgICAgICB0b2RvLmNvbXBsZXRlZCA9IGFsbENoZWNrZWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9J19hbGwudHMnIC8+XG5cbm1vZHVsZSB0b2RvcyB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHRvZG9tdmMgPSBhbmd1bGFyLm1vZHVsZSgndG9kb212YycsW10pXG4gICAgICAgIC5zZXJ2aWNlKCd0b2RvU3RvcmFnZScsVG9kb1N0b3JhZ2UpXG4gICAgICAgIC5jb250cm9sbGVyKCd0b2RvQ3RyJyxUb2RvQ3RybClcbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9J3R5cGluZ3MvanF1ZXJ5L2pxdWVyeS5kLnRzJyAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD0ndHlwaW5ncy9hbmd1bGFyanMvYW5ndWxhci5kLnRzJyAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD0nbW9kZWwudHMnIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPSdpbnRlcmZhY2VzLnRzJyAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD0nVG9kb1N0b3JhZ2UudHMnIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPSd0b2RvQ3RybC50cycgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9J2FwcGxpY2F0aW9uLnRzJyAvPlxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
